# Rust Guardian: CLI & Library Reference Guide

Rust Guardian is a dynamic code quality enforcement tool and library for Rust projects. It is designed to prevent incomplete code, enforce architectural boundaries, and maintain high standards throughout the development lifecycle.

---

## CLI COMMANDS REFERENCE

### 1. `rust-guardian check [paths...]`
**High-Level Functionality:**
Performs a static analysis of the specified files or directories to identify code quality violations based on configured patterns (Regex, AST, or Semantic).

**Example Situations:**
- **CI/CD Pipelines:** Running as a gatekeeper in a GitHub Action or GitLab CI to ensure no `unimplemented!` macros or `TODO` markers reach the main branch.
- **Pre-commit Hooks:** Validating staged changes to ensure local code quality before pushing.
- **On-demand Audits:** Scanning a specific module (`rust-guardian check src/auth/`) to find technical debt.

**Pertinent Details:**
- **Caching:** Use `--cache` to speed up subsequent runs by only analyzing changed files.
- **Output Formats:** Supports `human`, `json`, `junit`, `sarif`, `github`, and `agent` formats for integration with various tools.
- **Fail Fast:** Use `--fail-fast` to stop execution immediately upon encountering the first violation.
- **Severity Filtering:** Filter output using `--severity <level>` (error, warning, info).

---

### 2. `rust-guardian watch [paths...]`
**High-Level Functionality:**
Starts a persistent background process that monitors the specified directories for file changes and re-runs validations in real-time.

**Example Situations:**
- **Local Development:** Running in a dedicated terminal pane while coding to get instant feedback on placeholder usage or architectural violations.
- **Hot-Config Testing:** Developing and testing new `guardian.yaml` rules with immediate feedback as you modify the configuration.

**Pertinent Details:**
- **Debouncing:** Use `--debounce <ms>` (e.g., `--debounce 500`) to prevent excessive re-validation during rapid saving.
- **Hot Reloading:** Automatically reloads `guardian.yaml` when changes are detected, allowing for seamless rule adjustments.

---

### 3. `rust-guardian validate-config [config_file]`
**High-Level Functionality:**
Verifies the syntax and structural integrity of a `guardian.yaml` file.

**Example Situations:**
- **Rule Development:** After adding complex Regex or AST patterns to your config, ensuring the YAML structure and pattern syntax are correct before deployment.

---

### 4. `rust-guardian rules`
**High-Level Functionality:**
Lists all available and configured rules, providing a birds-eye view of the current enforcement policy.

**Example Situations:**
- **Onboarding:** Helping new team members understand which coding standards are being automatically enforced.
- **Configuration Review:** Verifying which rules are currently enabled via `--enabled-only`.

---

### 5. `rust-guardian explain <rule_id>`
**High-Level Functionality:**
Provides a detailed explanation for a specific rule ID, including why it exists and how to resolve violations.

**Example Situations:**
- **Troubleshooting:** When a developer encounters a violation like `RG001` and needs more context than the short error message provides.

---

### 6. `rust-guardian cache [stats|clear]`
**High-Level Functionality:**
Manages the internal file hash cache used to optimize performance.

**Example Situations:**
- **Performance Debugging:** Checking `cache stats` to see the hit/miss ratio.
- **Resetting State:** Using `cache clear` if you suspect the cache has become inconsistent or to perform a "clean" full scan.

---

## KEY PATTERN TYPES

Rust Guardian categorizes rules into three distinct levels of analysis:

1.  **Regex Patterns:** Fast, text-based matching for simple placeholders like `TODO`, `FIXME`, or specific forbidden strings.
2.  **AST Patterns:** Syntax-aware analysis using `syn` to detect specific Rust constructs, such as usage of `unimplemented!`, `panic!`, or specific attribute macros.
3.  **Semantic Patterns:** Advanced logic that understands project structure, primarily used for enforcing import boundaries (e.g., "Module A cannot import from Module B").

---

## CONFIGURATION & EXCLUSIONS

- **`guardian.yaml`:** The central configuration file. Defines include/exclude paths, rule severities, and custom patterns.
- **`.guardianignore`:** Supports `.gitignore`-style syntax to exclude specific files or directories from all scans.
- **Path Patterns:** Supports globbing (`*`, `**`, `?`, `[]`) for granular control over which files are analyzed.

---

## LIBRARY USAGE (for Developers)

For programmatic integration, the `rust_guardian` crate provides:
- **`GuardianValidator`:** The primary interface for running validations from within Rust code.
- **`validate_async`:** Enables high-performance, asynchronous scanning within `tokio` or other async runtimes.
- **Extensible Reporting:** Programmatically process `ValidationReport` and `Violation` structs to build custom dashboards or integrations.

---
*Last Updated: January 2026*
