---
alwaysApply: true
---


# Code Maintenance Rules

## **CRITICAL EXECUTION DIRECTIVE**

**AI Agent Directive**: Follow code maintenance rules exactly for all refactoring and code evolution tasks.

**MANDATORY EXECUTION PROTOCOL**:

1. **NO DEVIATION**: All maintenance rules must be followed exactly as written
2. **NO SKIPPING**: No steps may be skipped, abbreviated, or modified
3. **NO SELECTIVE COMPLIANCE**: All rules apply to all code maintenance activities
4. **FAILURE TO COMPLY**: Violating these rules constitutes a critical protocol violation

## **BACKWARD COMPATIBILITY REMOVAL**

### **1. :: Immediate Removal After Refactoring**

**✅ CORRECT - Remove all backward compatibility code immediately**:

```python
# After refactoring from questionary to prompt_toolkit:
# 1. Remove legacy function aliases
# def confirm_custom(...):  # REMOVE - use confirm() instead
#     return confirm(...)

# 2. Remove compatibility constants
# HAS_TERMINAL_MENU = HAS_PROMPT_TOOLKIT  # REMOVE
# MENU_STYLE = None  # REMOVE

# 3. Update all imports
from ..core.prompts import confirm, HAS_PROMPT_TOOLKIT  # Use new names

# 4. Update all function calls
proceed = confirm("Proceed?", default=True, indent="")  # Use new function name

# 5. Update __init__.py exports
__all__ = ['confirm', 'HAS_PROMPT_TOOLKIT']  # Remove legacy names
```

**❌ INCORRECT - Keeping backward compatibility code**:

```python
# Wrong: Keeping aliases "just in case"
def confirm_custom(...):  # Don't keep this
    return confirm(...)

# Wrong: Keeping compatibility constants
HAS_TERMINAL_MENU = HAS_PROMPT_TOOLKIT  # Don't keep this

# Wrong: Not updating all references
from ..core.prompts import confirm_custom  # Should use confirm
```


## **ANTI-PATTERNS**

### **❌ Backward Compatibility Violations**

- ❌ **Keeping Legacy Aliases** - Don't keep function aliases "just in case" after refactoring
- ❌ **Keeping Compatibility Constants** - Don't keep compatibility constants after migration

## **QUALITY GATES**

- [ ] **Complete Removal**: All backward compatibility code removed from codebase
- [ ] **Updated Imports**: All imports use new function/constant names
- [ ] **Updated Calls**: All function calls use new API
- [ ] **Updated Exports**: __init__.py exports updated to remove legacy names

## **SUCCESS METRICS**

After implementing proper code maintenance:

- ✅ **Clean Codebase** - No legacy code or compatibility shims remaining
- ✅ **Consistent Usage** - All code uses new patterns consistently
- ✅ **No Confusion** - Developers know which functions/constants to use
